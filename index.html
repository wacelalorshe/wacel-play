<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ - Ù…ØªØ¬Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠ</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ - Ù…ØªØ¬Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ Ù„ØªØ­Ù…ÙŠÙ„ Ø£ÙØ¶Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨">
    <meta name="keywords" content="ØªØ·Ø¨ÙŠÙ‚Ø§Øª, Ø£Ù„Ø¹Ø§Ø¨, ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ, Ù…ØªØ¬Ø± ØªØ·Ø¨ÙŠÙ‚Ø§Øª, ØªØ­Ù…ÙŠÙ„ ØªØ·Ø¨ÙŠÙ‚Ø§Øª">
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#4361ee">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="theme-color" content="#4361ee">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/300/300218.png">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/300/300218.png">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json" crossorigin="use-credentials">
    
    <!-- Styles & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles/style.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    <!-- Eruda for Mobile Debugging -->
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <style>
        /* Ø£Ù†Ù…ÙŠØ´Ù† Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ */
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Eruda */
        .eruda-container {
            direction: ltr !important;
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <nav class="top-navbar">
        <div class="nav-container">
            <div class="logo-section">
                <h1 class="logo"><i class="fab fa-google-play"></i> ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ</h1>
            </div>
            <div class="nav-actions">
                <div class="search-icon-top" id="searchIconTop">
                    <i class="fas fa-search"></i>
                </div>
                <button id="loginBtn" class="icon-btn">
                    <span class="icon-w">W</span>
                </button>
                <button id="logoutBtn" class="btn-logout" style="display:none;">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="main-content">
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù‡ÙŠØ±Ùˆ -->
        <section class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">Ø§ÙƒØªØ´Ù Ø¹Ø§Ù„Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</h1>
                <p class="hero-subtitle">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© Ù…Ù† ÙˆØ³ÙŠÙ„ Ø³ØªÙˆØ± Ù…Ø¬Ø§Ù†Ø§Ù‹</p>
            </div>
        </section>

        <!-- Ø´Ø±ÙŠØ· ØªØµÙÙŠØ© Ø§Ù„ÙØ¦Ø§Øª -->
        <section class="categories-section">
            <div class="categories-scroll-container">
                <div class="categories-scroll">
                    <button class="category-filter active" data-category="all" onclick="filterApps('all')">
                        <i class="fas fa-th-large"></i>
                        <span>Ø§Ù„ÙƒÙ„</span>
                    </button>
                    <button class="category-filter" data-category="games" onclick="filterApps('games')">
                        <i class="fas fa-gamepad"></i>
                        <span>Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</span>
                    </button>
                    <button class="category-filter" data-category="social" onclick="filterApps('social')">
                        <i class="fas fa-comments"></i>
                        <span>Ø§Ù„ØªÙˆØ§ØµÙ„</span>
                    </button>
                    <button class="category-filter" data-category="entertainment" onclick="filterApps('entertainment')">
                        <i class="fas fa-film"></i>
                        <span>Ø§Ù„ØªØ±ÙÙŠÙ‡</span>
                    </button>
                    <button class="category-filter" data-category="productivity" onclick="filterApps('productivity')">
                        <i class="fas fa-briefcase"></i>
                        <span>ÙØªÙˆØºØ±Ø§ÙÙŠ</span>
                    </button>
                    <button class="category-filter" data-category="education" onclick="filterApps('education')">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</span>
                    </button>
                    <button class="category-filter" data-category="utility" onclick="filterApps('utility')">
                        <i class="fas fa-tools"></i>
                        <span>Ø§Ù„Ø£Ø¯ÙˆØ§Øª</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª -->
        <section class="all-apps-section">
            <div class="section-header">
                <h2 class="section-title">ÙƒÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</h2>
            </div>
            <div id="apps-list" class="apps-grid">
                <div class="loading-state">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª...</p>
                </div>
            </div>
            <div id="load-more-container" class="load-more-container" style="display: none;">
                <button id="loadMoreBtn" class="load-more-btn">
                    <i class="fas fa-chevron-down"></i>
                    Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
                </button>
            </div>
        </section>

        <!-- Ø£Ù‚Ø³Ø§Ù… Ø®Ø§ØµØ© -->
        <section class="special-sections">
            <div class="section-tabs">
                <button class="section-tab" data-section="featured" onclick="displaySpecialSection('featured')">
                    <i class="fas fa-star"></i>
                    <span>Ù…Ù‚ØªØ±Ø­Ø© Ù„Ùƒ</span>
                </button>
                <button class="section-tab" data-section="trending" onclick="displaySpecialSection('trending')">
                    <i class="fas fa-fire"></i>
                    <span>Ø§Ù„Ø£ÙƒØ«Ø± Ø±ÙˆØ§Ø¬Ø§Ù‹</span>
                </button>
                <button class="section-tab" data-section="top" onclick="displaySpecialSection('top')">
                    <i class="fas fa-crown"></i>
                    <span>Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</span>
                </button>
            </div>
            
            <div id="featured-section" class="special-section-content" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title">Ù…Ù‚ØªØ±Ø­Ø© Ù„Ùƒ</h2>
                </div>
                <div id="featured-apps" class="apps-grid">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù‡Ù†Ø§ -->
                </div>
            </div>
            
            <div id="trending-section" class="special-section-content" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title">Ø§Ù„Ø£ÙƒØ«Ø± Ø±ÙˆØ§Ø¬Ø§Ù‹</h2>
                </div>
                <div id="trending-apps" class="apps-grid">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© Ù‡Ù†Ø§ -->
                </div>
            </div>
            
            <div id="top-section" class="special-section-content" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title">Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
                </div>
                <div id="top-apps" class="apps-grid">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù‡Ù†Ø§ -->
                </div>
            </div>
        </section>

        <!-- Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù‚ØªØ±Ø­Ø© -->
        <section class="ads-section">
            <div class="section-header">
                <h2 class="section-title">Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù‚ØªØ±Ø­Ø© Ù„Ùƒ</h2>
            </div>
            <div class="ads-grid">
                <div class="ad-card">
                    <div class="ad-badge">2025</div>
                    <h3>Ø§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© - Ø¨Ø¯ÙˆÙ† Ù…Ø¹Ø¯Ø§Øª</h3>
                    <p>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¬Ø³Ù… Ù…Ø«Ø§Ù„ÙŠ Ù…Ù† Ù…Ù†Ø²Ù„Ùƒ</p>
                </div>
                <div class="ad-card">
                    <div class="ad-badge">Ø¬Ø¯ÙŠØ¯</div>
                    <h3>Ø¯ÙˆØ±Ø§Øª ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ©</h3>
                    <p>Ø·ÙˆØ± Ù…Ù‡Ø§Ø±Ø§ØªÙƒ Ù…Ø¹ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø¯Ø±Ø¨ÙŠÙ†</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ -->
    <nav class="bottom-navbar">
        <div class="bottom-nav-container">
            <a href="#games" class="bottom-nav-item active">
                <i class="fas fa-gamepad"></i>
                <span>Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</span>
            </a>
            <a href="#apps" class="bottom-nav-item">
                <i class="fas fa-th-large"></i>
                <span>Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</span>
            </a>
            <a href="#search" class="bottom-nav-item" id="bottomSearchBtn">
                <i class="fas fa-search"></i>
                <span>Ø¨Ø­Ø«</span>
            </a>
        </div>
    </nav>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚ -->
    <div id="searchModal" class="modal">
        <div class="modal-content search-modal">
            <span class="close">&times;</span>
            <div class="search-container">
                <div class="search-bar">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª...">
                    <button class="search-btn" onclick="performSearch()">Ø¨Ø­Ø«</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3><i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
            <form id="loginForm">
                <div class="form-group">
                    <input type="email" id="loginEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
                </div>
                <button type="submit" class="submit-btn">
                    <i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>
            </form>
            <div id="loginMessage"></div>
            
            <div class="test-credentials">
                <h4><i class="fas fa-info-circle"></i> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h4>
                <p><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</strong> admin@wacelmarkt.com</p>
                <p><strong>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</strong> Admin123456</p>
            </div>
        </div>
    </div>

    <!-- Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª (Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹) -->
    <div id="pwa-install-container"></div>

    <!-- Ù„ÙˆØ­Ø© ØªØµØ­ÙŠØ­ PWA -->
    <div id="pwa-debug-panel"></div>

    <!-- ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª JavaScript -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>

    <!-- Ù†Ø¸Ø§Ù… PWA Ùˆ Eruda -->
    <script>
        // ØªÙØ¹ÙŠÙ„ Eruda Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ
        console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµØ­ÙŠØ­...');
        
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Eruda
        eruda.init({
            tool: ['console', 'elements', 'network', 'resources', 'sources', 'info'],
            defaults: {
                displaySize: 50,
                transparency: 0.9,
                theme: 'Dark'
            }
        });

        // Ø¥Ø¶Ø§ÙØ© Ø²Ø± ØªØ­ÙƒÙ… Ø¨Ù€ Eruda
        const erudaBtn = document.createElement('button');
        erudaBtn.innerHTML = 'ğŸ”§';
        erudaBtn.style.cssText = `
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: #4361ee;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            z-index: 10000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        `;
        erudaBtn.onclick = () => {
            eruda.show();
        };
        document.body.appendChild(erudaBtn);

        // Ù†Ø¸Ø§Ù… PWA Ø§Ù„Ù…Ø­Ø³Ù†
        class PWAInstaller {
            constructor() {
                this.deferredPrompt = null;
                this.isAppInstalled = false;
                this.debugMode = true;
                this.init();
            }

            init() {
                console.log('ğŸŸ¢ ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… PWA Ù…Ø¹ Eruda...');
                this.createDebugPanel();
                this.checkManifest();
                this.setupServiceWorker();
                this.setupInstallPrompt();
                this.checkInstallStatus();
                this.setupFallbackInstall();
                this.showDebugInfo('System initialized with Eruda');
            }

            createDebugPanel() {
                if (!this.debugMode) return;

                const debugPanel = document.createElement('div');
                debugPanel.id = 'pwa-debug-panel';
                debugPanel.innerHTML = `
                    <div style="background: rgba(0,0,0,0.85); color: white; padding: 12px; border-radius: 12px; font-size: 12px; max-width: 320px; border: 2px solid #4361ee;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #555; padding-bottom: 8px;">
                            <strong>ğŸ”§ ØªØµØ­ÙŠØ­ PWA Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</strong>
                            <div>
                                <button onclick="pwaInstaller.toggleDebug()" style="margin-right: 5px; padding: 3px 8px; background: #666; color: white; border: none; border-radius: 3px; font-size: 10px;">Ø¥Ø®ÙØ§Ø¡</button>
                                <button onclick="document.getElementById('pwa-debug-panel').remove()" style="padding: 3px 8px; background: #ef4444; color: white; border: none; border-radius: 3px; font-size: 10px;">âœ•</button>
                            </div>
                        </div>
                        <div id="debug-content" style="line-height: 1.6;">
                            <div>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                        </div>
                        <div style="margin-top: 12px; display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
                            <button onclick="pwaInstaller.forceShowInstall()" style="padding: 6px; background: #4361ee; color: white; border: none; border-radius: 6px; font-size: 11px;">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª</button>
                            <button onclick="pwaInstaller.checkStatus()" style="padding: 6px; background: #10b981; color: white; border: none; border-radius: 6px; font-size: 11px;">ÙØ­Øµ Ø§Ù„Ø­Ø§Ù„Ø©</button>
                            <button onclick="pwaInstaller.testManifest()" style="padding: 6px; background: #f59e0b; color: white; border: none; border-radius: 6px; font-size: 11px;">ÙØ­Øµ Manifest</button>
                            <button onclick="pwaInstaller.showManualGuide()" style="padding: 6px; background: #8b5cf6; color: white; border: none; border-radius: 6px; font-size: 11px;">Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ«Ø¨ÙŠØª</button>
                        </div>
                    </div>
                `;
                
                debugPanel.style.cssText = `
                    position: fixed;
                    top: 80px;
                    right: 10px;
                    z-index: 9999;
                `;

                document.body.appendChild(debugPanel);
                this.debugPanel = debugPanel;
            }

            toggleDebug() {
                const content = this.debugPanel.querySelector('#debug-content');
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    this.showDebugInfo('ØªÙ… Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØµØ­ÙŠØ­');
                } else {
                    content.style.display = 'none';
                }
            }

            updateDebugInfo(content) {
                if (!this.debugMode || !this.debugPanel) return;
                
                const debugContent = this.debugPanel.querySelector('#debug-content');
                if (debugContent) {
                    debugContent.innerHTML = content;
                }
            }

            showDebugInfo(message) {
                console.log('ğŸ”§ ' + message);
                
                if (this.debugMode) {
                    const timestamp = new Date().toLocaleTimeString();
                    const status = `
                        <div style="color: #60a5fa;">ğŸ•’ ${timestamp}</div>
                        <div style="margin: 5px 0; padding: 5px; background: rgba(255,255,255,0.1); border-radius: 5px;">${message}</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3px; margin-top: 8px;">
                            <span>ğŸ“± Ø§Ù„ØªØ«Ø¨ÙŠØª:</span> <span style="color: ${this.isAppInstalled ? '#10b981' : '#ef4444'}">${this.isAppInstalled ? 'âœ…' : 'âŒ'}</span>
                            <span>ğŸ¯ Prompt:</span> <span style="color: ${this.deferredPrompt ? '#10b981' : '#ef4444'}">${this.deferredPrompt ? 'âœ…' : 'âŒ'}</span>
                            <span>ğŸ”§ Service Worker:</span> <span style="color: ${'serviceWorker' in navigator ? '#10b981' : '#ef4444'}">${'serviceWorker' in navigator ? 'âœ…' : 'âŒ'}</span>
                            <span>ğŸ“„ Manifest:</span> <span style="color: ${document.querySelector('link[rel="manifest"]') ? '#10b981' : '#ef4444'}">${document.querySelector('link[rel="manifest"]') ? 'âœ…' : 'âŒ'}</span>
                        </div>
                    `;
                    this.updateDebugInfo(status);
                }
            }

            checkManifest() {
                const manifestLink = document.querySelector('link[rel="manifest"]');
                if (!manifestLink) {
                    this.showDebugInfo('âŒ Manifest ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                    this.createFallbackManifest();
                    return;
                }

                this.showDebugInfo('ğŸ” Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Manifest...');
                
                fetch(manifestLink.href)
                    .then(response => {
                        if (!response.ok) throw new Error('Manifest ØºÙŠØ± Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ­Ù…ÙŠÙ„');
                        return response.json();
                    })
                    .then(manifest => {
                        this.showDebugInfo('âœ… Manifest Ù…Ø­Ù…Ù„: ' + manifest.name);
                        console.log('Manifest details:', manifest);
                    })
                    .catch(error => {
                        this.showDebugInfo('âŒ Ø®Ø·Ø£ ÙÙŠ Manifest: ' + error.message);
                        this.createFallbackManifest();
                    });
            }

            createFallbackManifest() {
                this.showDebugInfo('ğŸ”„ Ø¥Ù†Ø´Ø§Ø¡ Manifest Ø§Ø­ØªÙŠØ§Ø·ÙŠ...');
                
                const fallbackManifest = {
                    name: "ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ",
                    short_name: "ÙˆØ³ÙŠÙ„ Ø¨Ù„Ø§ÙŠ",
                    description: "Ù…ØªØ¬Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ",
                    start_url: "/",
                    display: "standalone",
                    background_color: "#4361ee",
                    theme_color: "#4361ee",
                    orientation: "portrait",
                    icons: [{
                        src: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjE5MiIgaGVpZ2h0PSIxOTIiIGZpbGw9IiM0MzYxZWUiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iNDgiPvCfjIo8L3RleHQ+PC9zdmc+",
                        sizes: "192x192",
                        type: "image/svg+xml"
                    }]
                };

                const manifestString = JSON.stringify(fallbackManifest);
                const blob = new Blob([manifestString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('link');
                link.rel = 'manifest';
                link.href = url;
                document.head.appendChild(link);
                
                this.showDebugInfo('âœ… Manifest Ø§Ø­ØªÙŠØ§Ø·ÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡');
            }

            setupServiceWorker() {
                if ('serviceWorker' in navigator) {
                    this.showDebugInfo('ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Service Worker...');
                    
                    navigator.serviceWorker.register('sw.js')
                        .then(registration => {
                            this.showDebugInfo('âœ… Service Worker Ù…Ø³Ø¬Ù„: ' + registration.scope);
                            
                            if (registration.installing) {
                                console.log('Service Worker Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ«Ø¨ÙŠØª...');
                            } else if (registration.waiting) {
                                console.log('Service Worker Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„');
                            } else if (registration.active) {
                                console.log('Service Worker Ù†Ø´Ø·');
                            }
                        })
                        .catch(error => {
                            this.showDebugInfo('âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Service Worker: ' + error.message);
                            console.error('Service Worker error:', error);
                        });
                } else {
                    this.showDebugInfo('âš ï¸ Service Worker ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­');
                }
            }

            setupInstallPrompt() {
                window.addEventListener('beforeinstallprompt', (e) => {
                    this.showDebugInfo('ğŸ‰ Ø­Ø¯Ø« beforeinstallprompt ØªÙ… ØªØ´ØºÙŠÙ„Ù‡!');
                    e.preventDefault();
                    this.deferredPrompt = e;
                    this.showInstallButton();
                });

                window.addEventListener('appinstalled', (evt) => {
                    this.showDebugInfo('âœ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ØªÙ… ØªØ«Ø¨ÙŠØªÙ‡ Ø¨Ù†Ø¬Ø§Ø­!');
                    this.isAppInstalled = true;
                    this.hideInstallButton();
                    this.showMessage('ğŸ‰ ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                });

                // Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¸Ù‡Ø± Ø§Ù„Ø­Ø¯Ø« Ø®Ù„Ø§Ù„ 3 Ø«ÙˆØ§Ù†ØŒ Ø£Ø¸Ù‡Ø± Ø§Ù„Ø²Ø± ÙŠØ¯ÙˆÙŠØ§Ù‹
                setTimeout(() => {
                    if (!this.deferredPrompt && !this.isAppInstalled) {
                        this.showDebugInfo('â° Ù„Ù… ÙŠØ¸Ù‡Ø± Ø­Ø¯Ø« Ø§Ù„ØªØ«Ø¨ÙŠØªØŒ Ø¹Ø±Ø¶ Ø§Ù„Ø²Ø± ÙŠØ¯ÙˆÙŠØ§Ù‹');
                        this.showInstallButton();
                    }
                }, 3000);
            }

            showInstallButton() {
                if (this.isInstalled()) {
                    this.showDebugInfo('âœ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø«Ø¨Øª Ø¨Ø§Ù„ÙØ¹Ù„');
                    return;
                }

                if (document.getElementById('pwa-install-button')) {
                    return;
                }

                this.showDebugInfo('ğŸ”„ Ø¹Ø±Ø¶ Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª...');

                const installBtn = document.createElement('button');
                installBtn.id = 'pwa-install-button';
                installBtn.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 8px; justify-content: center;">
                        <i class="fas fa-download" style="font-size: 16px;"></i>
                        <span>ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
                    </div>
                `;
                
                installBtn.style.cssText = `
                    position: fixed;
                    bottom: 120px;
                    right: 15px;
                    background: linear-gradient(135deg, #4361ee, #3a56d4);
                    color: white;
                    border: none;
                    padding: 14px 20px;
                    border-radius: 25px;
                    cursor: pointer;
                    z-index: 10000;
                    box-shadow: 0 4px 20px rgba(67, 97, 238, 0.4);
                    font-family: inherit;
                    font-weight: 600;
                    font-size: 14px;
                    transition: all 0.3s ease;
                    border: 2px solid white;
                `;

                installBtn.addEventListener('mouseenter', () => {
                    installBtn.style.transform = 'translateY(-3px)';
                    installBtn.style.boxShadow = '0 6px 25px rgba(67, 97, 238, 0.6)';
                });

                installBtn.addEventListener('mouseleave', () => {
                    installBtn.style.transform = 'translateY(0)';
                    installBtn.style.boxShadow = '0 4px 20px rgba(67, 97, 238, 0.4)';
                });

                installBtn.addEventListener('click', () => {
                    this.installApp();
                });

                document.body.appendChild(installBtn);
                this.showDebugInfo('âœ… Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª Ù…Ø¹Ø±ÙˆØ¶');

                // Ø¥Ø®ÙØ§Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ 25 Ø«Ø§Ù†ÙŠØ©
                setTimeout(() => {
                    this.hideInstallButton();
                }, 25000);
            }

            hideInstallButton() {
                const installBtn = document.getElementById('pwa-install-button');
                if (installBtn) {
                    installBtn.style.opacity = '0';
                    installBtn.style.transform = 'translateY(10px)';
                    setTimeout(() => {
                        if (installBtn.parentNode) {
                            installBtn.parentNode.removeChild(installBtn);
                            this.showDebugInfo('ğŸ”» Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª Ù…Ø®ÙÙŠ');
                        }
                    }, 300);
                }
            }

            async installApp() {
                if (this.deferredPrompt) {
                    try {
                        this.showDebugInfo('ğŸ”„ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ«Ø¨ÙŠØª...');
                        this.deferredPrompt.prompt();
                        const { outcome } = await this.deferredPrompt.userChoice;
                        
                        if (outcome === 'accepted') {
                            this.showDebugInfo('âœ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¨Ù„ Ø§Ù„ØªØ«Ø¨ÙŠØª');
                            this.showMessage('âœ… ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                            this.isAppInstalled = true;
                        } else {
                            this.showDebugInfo('âŒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±ÙØ¶ Ø§Ù„ØªØ«Ø¨ÙŠØª');
                            this.showMessage('âš ï¸ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ«Ø¨ÙŠØª', 'warning');
                        }
                        
                        this.deferredPrompt = null;
                    } catch (error) {
                        this.showDebugInfo('âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ«Ø¨ÙŠØª: ' + error.message);
                        this.showManualInstallGuide();
                    }
                } else {
                    this.showDebugInfo('ğŸ” deferredPrompt ØºÙŠØ± Ù…ØªÙˆÙØ±ØŒ Ø¹Ø±Ø¶ Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„ÙŠØ¯ÙˆÙŠ');
                    this.showManualInstallGuide();
                }
            }

            showManualInstallGuide() {
                const guide = `
                    <div style="text-align: center; padding: 25px; max-width: 320px; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
                        <h3 style="margin-bottom: 20px; color: #333;">ğŸ“± ÙƒÙŠÙÙŠØ© ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h3>
                        <div style="text-align: right; line-height: 2.2; color: #555; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="background: #4361ee; color: white; width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">1</span>
                                <span>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ <strong>Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø«Ù„Ø§Ø«</strong> â‹® Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØµÙØ­</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="background: #4361ee; color: white; width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">2</span>
                                <span>Ø§Ø®ØªØ± <strong>"Add to Home Screen"</strong></span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="background: #4361ee; color: white; width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">3</span>
                                <span>Ø§Ø¶ØºØ· <strong>"Add"</strong> Ø£Ùˆ <strong>"ØªØ«Ø¨ÙŠØª"</strong></span>
                            </div>
                        </div>
                        <button onclick="pwaInstaller.hideMessage()" style="padding: 12px 30px; background: #4361ee; color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">Ø­Ø³Ù†Ø§Ù‹</button>
                    </div>
                `;
                this.showMessage(guide, 'manual');
            }

            showManualGuide() {
                this.showManualInstallGuide();
            }

            showMessage(text, type) {
                // Ø¥Ø®ÙØ§Ø¡ Ø£ÙŠ Ø±Ø³Ø§Ø¦Ù„ Ø³Ø§Ø¨Ù‚Ø©
                this.hideMessage();

                const message = document.createElement('div');
                message.innerHTML = text;
                message.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    z-index: 10002;
                    animation: slideInRight 0.3s ease;
                `;
                document.body.appendChild(message);
                this.currentMessage = message;
            }

            hideMessage() {
                if (this.currentMessage && this.currentMessage.parentNode) {
                    this.currentMessage.parentNode.removeChild(this.currentMessage);
                    this.currentMessage = null;
                }
            }

            forceShowInstall() {
                this.showInstallButton();
                this.showDebugInfo('ğŸ”„ Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª ÙŠØ¯ÙˆÙŠØ§Ù‹');
            }

            checkStatus() {
                const status = {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    cookieEnabled: navigator.cookieEnabled,
                    onLine: navigator.onLine,
                    serviceWorker: 'serviceWorker' in navigator,
                    manifest: !!document.querySelector('link[rel="manifest"]'),
                    installed: this.isInstalled(),
                    deferredPrompt: !!this.deferredPrompt
                };
                
                this.showDebugInfo('ğŸ” ÙØ­Øµ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠ');
                console.log('PWA Status Check:', status);
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ Eruda console
                eruda.get('console').log('PWA Status:', status);
            }

            testManifest() {
                this.showDebugInfo('ğŸ” ÙØ­Øµ Manifest ØªÙØµÙŠÙ„ÙŠ');
                this.checkManifest();
            }

            isInstalled() {
                const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
                const isInWebApp = window.navigator.standalone;
                
                if (isStandalone || isInWebApp) {
                    this.isAppInstalled = true;
                    return true;
                }
                return false;
            }

            setupFallbackInstall() {
                // Ø²Ø± ØªØ«Ø¨ÙŠØª ÙŠØ¯ÙˆÙŠ Ø¥Ø¶Ø§ÙÙŠ ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ 8 Ø«ÙˆØ§Ù†ÙŠ
                setTimeout(() => {
                    if (!this.isAppInstalled && !this.deferredPrompt) {
                        this.showDebugInfo('ğŸ”„ Ø¥Ø¸Ù‡Ø§Ø± Ø®ÙŠØ§Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„ÙŠØ¯ÙˆÙŠ');
                        this.showInstallButton();
                    }
                }, 8000);
            }
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¯ Ø¨Ø¯Ø¡ Ù†Ø¸Ø§Ù… PWA Ù…Ø¹ Eruda...');
            window.pwaInstaller = new PWAInstaller();

            // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ ÙÙŠ Eruda
            eruda.get('console').log('ğŸ‰ Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØµØ­ÙŠØ­ Ù…ÙØ¹Ù„Ø©');
            eruda.get('console').log('ğŸ”§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ÙØ­Øµ Console ÙˆØ§Ù„Ø¹Ù†Ø§ØµØ± ÙˆØ§Ù„Ø´Ø¨ÙƒØ©');
            eruda.get('console').log('ğŸ“± Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± PWA Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØªØ«Ø¨ÙŠØª');

            // Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            document.getElementById('searchIconTop').addEventListener('click', function() {
                document.getElementById('searchModal').style.display = 'block';
            });

            document.getElementById('bottomSearchBtn').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('searchModal').style.display = 'block';
            });

            document.querySelectorAll('.close').forEach(function(closeBtn) {
                closeBtn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });

            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });

            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            document.querySelectorAll('.bottom-nav-item').forEach(function(item) {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.bottom-nav-item').forEach(function(i) {
                        i.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    const target = this.getAttribute('href');
                    if (target === '#games') {
                        filterApps('games');
                    } else if (target === '#apps') {
                        filterApps('all');
                    } else if (target === '#search') {
                        document.getElementById('searchModal').style.display = 'block';
                    }
                });
            });

            console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØµØ­ÙŠØ­");
        });

        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
        window.performSearch = performSearch;
        window.filterApps = filterApps;
        window.displaySpecialSection = displaySpecialSection;
    </script>
</body>
</html>
